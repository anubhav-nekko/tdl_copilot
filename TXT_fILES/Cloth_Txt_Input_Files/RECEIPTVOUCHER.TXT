; Created By: Khokan on 2021-07-14 12:36, ID: 

;==============================================================================
; SECTION: VCHBILL CTLineOne
; Description: Defines the first line of the voucher bill with receipt option
; and adds custom fields after VCH ShortTitle
;==============================================================================
[#line : VCHBILL CTLineOne]
; Add receipt option to the line
add:option:CTLineOneopt:@@isreceipt
[!line:CTLineOneopt]

; Add custom fields after VCH ShortTitle
add : fields : after : VCH ShortTitle : snf,snf2, snf3, snf4, snf5, snf6

; Set field values from company captions
Local: Field: snf: Set As:$cwcaption1:COMPANY:##SVCURRENTCOMPANY
Local: Field: snf2: Set As:$cwcaption2:COMPANY:##SVCURRENTCOMPANY
Local: Field: snf3: Set As:$cwcaption3:COMPANY:##SVCURRENTCOMPANY
Local: Field: snf4: Set As:$cwcaption4:COMPANY:##SVCURRENTCOMPANY
Local: Field: snf5: Set As:$cwcaption5:COMPANY:##SVCURRENTCOMPANY
Local: Field: snf6: Set As:$cwcaption6:COMPANY:##SVCURRENTCOMPANY

; Skip these fields in the UI
Local: Field: snf: Skip: Yes
Local: Field: snf2: Skip: Yes
Local: Field: snf3: Skip: Yes
Local: Field: snf4: Skip: Yes
Local: Field: snf5: Skip: Yes
Local: Field: snf6: Skip: Yes

;==============================================================================
; SECTION: VCHBILL CTLineTwo
; Description: Defines the second line of the voucher bill with receipt option
; and adds custom fields after VCH ShortTitle
;==============================================================================
[#line : VCHBILL CTLineTwo]
; Add receipt option to the line
add:option:CTLineOneopt2:@@isreceipt
[!line:CTLineOneopt2]

; Add custom fields after VCH ShortTitle
add : fields : after : VCH ShortTitle : snf,snf2, snf3, snf4, snf5, snf6

; Initialize info fields with empty values
Local: Field: snf : info:""
Local: Field: snf1 : info:""
Local: Field: snf2 : info:""
Local: Field: snf3 : info:""
Local: Field: snf4 : info:""
Local: Field: snf5 : info:""
Local: Field: snf6 : info:""
Local: Field: snf7 : info:""

;==============================================================================
; SECTION: VCHBILL CTLineThree
; Description: Defines the third line of the voucher bill with receipt option
; and adds custom fields after VCH ShortTitle
;==============================================================================
[#line : VCHBILL CTLineThree]
; Add receipt option to the line
add:option:CTLineOneopt3:@@isreceipt
[!line:CTLineOneopt3]

; Add custom fields after VCH ShortTitle
add : fields : after : VCH ShortTitle : snf, snf2, snf3, snf4, snf5, snf6

; Initialize info fields with empty values
Local: Field: snf : info:""
Local: Field: snf1 : info:""
Local: Field: snf2 : info:""
Local: Field: snf3 : info:""
Local: Field: snf4 : info:""
Local: Field: snf5 : info:""
Local: Field: snf6 : info:""
Local: Field: snf7 : info:""

;==============================================================================
; SECTION: VCHBILL MainLine
; Description: Defines the main line of the voucher bill with receipt option
; and adds custom fields after VCHBILLName
;==============================================================================
[#Line: VCHBILL MainLine]
; Add receipt option to the line
add:option:CTLineOneopt4:@@isreceipt
[!line:CTLineOneopt4]

; Add custom fields after VCHBILLName
add : fields : after : VCHBILLName :snf,snf2,snf3, snf4, snf5, snf6

; Define storage variables for caption values
Local: Field: snf: storage:cwcaption1vch
Local: Field: snf2: storage:cwcaption2vch
Local: Field: snf3: storage:cwcaption3vch
Local: Field: snf4: storage:cwcaption4vch
Local: Field: snf5: storage:cwcaption5vch
Local: Field: snf6: storage:cwcaption6vch

; Set field values based on ledger information
Local: Field: nf : set as:#allocname ;;$cwcaption1vch:ledger:$ledgername
Local: Field: snf : set as:$cwcaption1item:ledger:#allocname
Local: Field: snf2: set as:$cwcaption2item:ledger:#allocname
Local: Field: snf3: set as:$cwcaption3item:ledger:#allocname
Local: Field: snf4:set as:$cwcaption4item:ledger:#allocname
Local: Field: snf5:set as:$cwcaption5item:ledger:#allocname
Local: Field: snf6:set as:$cwcaption6item:ledger:#allocname

; Force string type for all custom fields
local: field: snf: type: String:forced
local: field: snf2: type: String:forced
local: field: snf3: type: String:forced
local: field: snf4: type: String:forced
local: field: snf5: type: String:forced
local: field: snf6: type: String:forced

; Skip fields conditionally based on company caption values
local: field: snf: skip:if $$isempty:($cwcaption1:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf2: skip:if $$isempty:($cwcaption2:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf3: skip:if $$isempty:($cwcaption3:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf4: skip:if $$isempty:($cwcaption4:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf5: skip:if $$isempty:($cwcaption5:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf6: skip:if $$isempty:($cwcaption6:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"

; Set fields as inactive if BillDate or Name is empty
local: field: snf:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf1:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf2:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf3:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf4:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf5:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf6:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name

; Configure table settings for snf field based on company caption table type
Local:Field:snf:table:cwcaption1tableundercc,Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf:Show table: Always
Local: Field:snf:Table : cwcaption1tableundersc, Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf:Table : cwcaption1tableunderled, Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf field based on company caption table type
Local: Field:snf:option:optcc:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf:option:optsc:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf:option:optled:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf: Style: Normal Bold

; Configure table settings for snf2 field based on company caption table type
Local:Field:snf2:table:cwcaption2tableundercc,Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf2:Show table: Always
Local: Field:snf2:Table : cwcaption2tableundersc, Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf2:Table : cwcaption2tableunderled, Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf2 field based on company caption table type
Local: Field:snf2:option:optcc:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf2:option:optsc:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf2:option:optled:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf3 field based on company caption table type
Local:Field:snf3:table:cwcaption3tableundercc,Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf3:Show table: Always
Local: Field:snf3:Table      : cwcaption3tableundersc, Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf3:Table      : cwcaption3tableunderled, Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf3 field based on company caption table type
Local: Field:snf3:option:optcc:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf3:option:optsc:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf3:option:optled:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf3: Style: Normal Bold

; Configure table settings for snf4 field based on company caption table type
Local:Field:snf4:table:cwcaption4tableundercc,Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf4:Show table: Always
Local: Field:snf4:Table      : cwcaption4tableundersc, Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf4:Table      : cwcaption4tableunderled, Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf4 field based on company caption table type
Local: Field:snf4:option:optcc:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf4:option:optsc:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf4:option:optled:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf5 field based on company caption table type
Local:Field:snf5:table:cwcaption5tableundercc,Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf5:Show table: Always
Local: Field:snf5:Table      : cwcaption5tableundersc, Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf5:Table      : cwcaption5tableunderled, Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf5 field based on company caption table type
Local: Field:snf5:option:optcc:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf5:option:optsc:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf5:option:optled:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf6 field based on company caption table type
Local:Field:snf6:table:cwcaption6tableundercc,Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf6:Show table: Always
Local: Field:snf6:Table      : cwcaption6tableundersc, Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf6:Table      : cwcaption6tableunderled, Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf6 field based on company caption table type
Local: Field:snf6:option:optcc:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf6:option:optsc:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf6:option:optled:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf6: Style: Normal Bold

;==============================================================================
; SECTION: VCHBILL ExplLine
; Description: Defines the explanation line of the voucher bill with receipt option
; and adds custom fields after VCHBILLName
;==============================================================================
[#Line: VCHBILL ExplLine]
; Add receipt option to the line
add:option:CTLineOneopt5:@@isreceipt
[!line:CTLineOneopt5]

; Add custom fields after VCHBILLName
add : fields : after : VCHBILLName :snfx,snf,snf9,snf2,snf10,snf3, snf4, snf5, snf6

; Set caption fields with colon suffix
Local: Field: snfx: Set As:$cwcaption1:COMPANY:##SVCURRENTCOMPANY+" :"
Local: Field: snf9: Set As:$cwcaption2:COMPANY:##SVCURRENTCOMPANY+" :"
Local: Field: snf10: Set As:$cwcaption3:COMPANY:##SVCURRENTCOMPANY+" :"

; Skip these fields in the UI
Local: Field: snfx: Skip: Yes
Local: Field: snf9: Skip: Yes

; Set field width
local: field: snf: Width:25

; Define storage variables for caption values
Local: Field: snf: storage:cwcaption1vch
Local: Field: snf2: storage:cwcaption2vch
Local: Field: snf3: storage:cwcaption3vch
Local: Field: snf4: storage:cwcaption4vch
Local: Field: snf5: storage:cwcaption5vch
Local: Field: snf6: storage:cwcaption6vch

; Set ledger name field
Local: Field: nf9 : set as:$ledgername

; Force string type for all custom fields
local: field: snf: type: String:forced
local: field: snf2: type: String:forced
local: field: snf3: type: String:forced
local: field: snf4: type: String:forced
local: field: snf5: type: String:forced
local: field: snf6: type: String:forced

; Skip fields conditionally based on company caption values
local: field: snf: skip:if $$isempty:($cwcaption1:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf2: skip:if $$isempty:($cwcaption2:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf3: skip:if $$isempty:($cwcaption3:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf4: skip:if $$isempty:($cwcaption4:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf5: skip:if $$isempty:($cwcaption5:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"
local: field: snf6: skip:if $$isempty:($cwcaption6:COMPANY:##SVCURRENTCOMPANY) then "yes" else "no"

; Set fields as inactive if BillDate or Name is empty
local: field: snf:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf1:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf2:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf3:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf4:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf5:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name
local: field: snf6:Inactive    : $$IsEmpty:$BillDate OR $$IsEmpty:$Name

; Configure table settings for snf field based on company caption table type
Local:Field:snf:table:cwcaption1tableundercc,Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf:Show table: Always
Local: Field:snf:Table : cwcaption1tableundersc, Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf:Table : cwcaption1tableunderled, Not Applicable:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf field based on company caption table type
Local: Field:snf:option:optcc:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf:option:optsc:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf:option:optled:$cwcaption1table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf: Style: Normal Bold

; Configure table settings for snf2 field based on company caption table type
Local:Field:snf2:table:cwcaption2tableundercc,Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf2:Show table: Always
Local: Field:snf2:Table : cwcaption2tableundersc, Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf2:Table : cwcaption2tableunderled, Not Applicable:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf2 field based on company caption table type
Local: Field:snf2:option:optcc:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf2:option:optsc:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf2:option:optled:$cwcaption2table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf3 field based on company caption table type
Local:Field:snf3:table:cwcaption3tableundercc,Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf3:Show table: Always
Local: Field:snf3:Table      : cwcaption3tableundersc, Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf3:Table      : cwcaption3tableunderled, Not Applicable:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf3 field based on company caption table type
Local: Field:snf3:option:optcc:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf3:option:optsc:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf3:option:optled:$cwcaption3table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf3: Style: Normal Bold

; Configure table settings for snf4 field based on company caption table type
Local:Field:snf4:table:cwcaption4tableundercc,Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf4:Show table: Always
Local: Field:snf4:Table      : cwcaption4tableundersc, Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf4:Table      : cwcaption4tableunderled, Not Applicable:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf4 field based on company caption table type
Local: Field:snf4:option:optcc:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf4:option:optsc:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf4:option:optled:$cwcaption4table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf5 field based on company caption table type
Local:Field:snf5:table:cwcaption5tableundercc,Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf5:Show table: Always
Local: Field:snf5:Table      : cwcaption5tableundersc, Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf5:Table      : cwcaption5tableunderled, Not Applicable:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf5 field based on company caption table type
Local: Field:snf5:option:optcc:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf5:option:optsc:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf5:option:optled:$cwcaption5table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Configure table settings for snf6 field based on company caption table type
Local:Field:snf6:table:cwcaption6tableundercc,Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local:Field:snf6:Show table: Always
Local: Field:snf6:Table      : cwcaption6tableundersc, Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf6:Table      : cwcaption6tableunderled, Not Applicable:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="ledger"

; Set options for snf6 field based on company caption table type
Local: Field:snf6:option:optcc:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Cost Centre"
Local: Field:snf6:option:optsc:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="Stock Category"
Local: Field:snf6:option:optled:$cwcaption6table:COMPANY:##SVCURRENTCOMPANY="ledger"
Local: Field: snf6: Style: Normal Bold
