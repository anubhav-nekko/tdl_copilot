;===============================================================================
;  Multi-Print “Salesman-Wise Outstanding” Statement                            ;
;  --------------------------------------------------------------------------  ;
;  • Original Snippet  : Khokan (06-Sep-2021)                                   ;
;-------------------------------------------------------------------------------;



;===============================================================================
; 1.  MENU HOOKS                                                                ;
;===============================================================================;

     [#menu: Gateway of Tally]                       ;<– primary Gateway menu
;; {06.Sep.21 19:30}         add: Option: multiprintSALESMANWISEOutstandingReportLock ;; : @@multiprintSALESMANWISEOutstandingReportDemoLock
;   – Option (currently commented) to insert a child menu that holds the report ;
;     list. Demo-lock variable can be activated via formula (see below).        ;


     [#menu : cw_Debug_menu]                         ;<– existing debug menu
        add: Item: before: @@locQuit: @@multiprintSALESMANWISEOutstandingReportReport: Display: RepmultiprintSALESMANWISEOutstandingReport
;   – Adds single-report shortcut inside debug menu, positioned before “Quit”.  ;


;-------------------------- 1.1 Child Menu (lock) -----------------------------;
     [!menu: multiprintSALESMANWISEOutstandingReportLock]
        add: Item: before: @@locQuit: @@multiprintSALESMANWISEOutstandingReportReport: print Collection: collRepmultiprintSALESMANWISEOutstandingReport
        add: Item: before: @@locQuit: Blank
;   – Same caption but triggers *print collection* for batch printing.          ;
;   – Followed by an empty spacer line.                                         ;



;===============================================================================
; 2.  FORMULAE (captions & demo lock)                                            ;
;===============================================================================;
    [System: formula]
   multiprintSALESMANWISEOutstandingReportReport : @@cwcaption2tableundernew + " " + "wise O/S Statement"
;; multiprintSALESMANWISEOutstandingReportDemoLock: $$MachineDate < $$Date:"01/04/2013"
;   – Caption dynamically uses Company-level caption-2 (e.g., “Salesman”).      ;
;   – Demo-lock (commented) restricts feature after a given date.               ;



;===============================================================================
; 3.  COLLECTION THAT DRIVES BATCH-PRINT LIST                                    ;
;===============================================================================;

       [Collection: collRepmultiprintSALESMANWISEOutstandingReport]
  Use               : Extract Alias Collection
  Source Collection : List of Ledgers
  Variable          : Ledger Name
  Report            : RepmultiprintSALESMANWISEOutstandingReport
  Trigger           : cwLedgerName2
  Fetch             : Name
;   – Creates pick-list of ledgers (salesmen) for multi-print run.              ;


;===============================================================================
; 4.  REPORT DERIVED FROM “AGENT-WISE Outstanding”                              ;
;===============================================================================;

    [Report: RepmultiprintSALESMANWISEOutstandingReport]
    
    Use    : RepmultiprintAGENTWISEOutstandingReport    ;<– inherit base design
    
    ;---- remove old “Agent-Wise” caption & printset --------------------------;
    Delete : Title    : @@multiprintAGENTWISEOutstandingReportReport
    Delete : Printset : Report Title: @@multiprintAGENTWISEOutstandingReportReport
    
    ;---- add new “Salesman-Wise” caption & printset -------------------------;
    Add    : Title    : @@multiprintSALESMANWISEOutstandingReportReport
    Add    : Printset : Report Title: @@multiprintSALESMANWISEOutstandingReportReport
    
;; {06.Sep.21 17:19}        Form: FrmmultiprintSALESMANWISEOutstandingReport
;; {06.Sep.21 17:19}      Export: Yes
;; {06.Sep.21 17:19}      set  : svfromdate : ##svcurrentdate
;; {06.Sep.21 17:19}      set  : svTodate : ##svcurrentdate
;; {06.Sep.21 17:19}     Local       : Button   : RelReports        : Inactive : Yes
;   – Form/export/date-range overrides retained but commented (original code).  ;


;---------------- 4.1  Override printed page titles inside inherited parts -----;
local:part: multiprintAGENTWISEOutstandingReportTitlePart:local:line:DSPCompanyName:Local: Field:nf: Set As: @@multiprintSALESMANWISEOutstandingReportReport
local:part: PrtTitle0multiprintAGENTWISEOutstandingReport:local:line:DSPCompanyName:Local: Field:nf: Set As: @@multiprintSALESMANWISEOutstandingReportReport



;---------------- 4.2  Adjust collection filters to pick chosen Salesman -------;
 local:Collection: ColmultiprintAGENTWISEOutstandingReport            : delete: filter : cwnotcloingbalancemultiprint
 local:Collection: ColmultiprintAGENTWISEOutstandingReport            : add   : filter : cwnotcloingbalancemultiprintitem2
 
 local:Collection: ColmultiprintAGENTWISEOutstandingReporta           : delete: filter : ColmultiprintAGENTWISEOutstandingReportFilterdr
 local:Collection: ColmultiprintAGENTWISEOutstandingReportb           : delete: filter : ColmultiprintAGENTWISEOutstandingReportFiltercr
 
 local:Collection: ColmultiprintAGENTWISEOutstandingReporta           : add   : filter : ColmultiprintAGENTWISEOutstandingReportFiltercritem2
 local:Collection: ColmultiprintAGENTWISEOutstandingReportb           : add   : filter : ColmultiprintAGENTWISEOutstandingReportFilterdritem2x

;---------------- 4.3  Show current Salesman name at runtime -------------------;
  local:part: multiagentpart : local:line:multiprintAGENTline : Local: Field: fwf: Set As: ##LedgerName



;===============================================================================
; 5.  ADDITIONAL FORMULAE FOR NEW FILTERS                                        ;
;===============================================================================;
 [System: Formula]
 cwnotcloingbalancemultiprintitem2                : ##ledgername = $cwcaption2item           and (NOT $$isempty:$OnAccountValue OR NOT $$isempty:$closingbalance)
 ColmultiprintAGENTWISEOutstandingReportFiltercritem2 : if $cwcaption2item:ledger:$parent = ##LedgerName then $$isdr:$closingbalance     else No
 ColmultiprintAGENTWISEOutstandingReportFilterdritem2x: if $cwcaption2item:ledger:$parent = ##LedgerName then NOT $$isdr:$closingbalance else No



;===============================================================================
;                                 END OF FILE                                   ;
;===============================================================================